prefix_rule(pattern=[".venv/bin/python", "-m", "pip", "install"], decision="allow")
prefix_rule(pattern=["python3", "-m", "pip", "install", "--user"], decision="allow")
prefix_rule(pattern=["docker", "compose"], decision="allow")
prefix_rule(pattern=["./scripts/docker-deploy.sh"], decision="allow")
prefix_rule(pattern=["git", "clone"], decision="allow")
prefix_rule(pattern=["python", "-m", "compileall"], decision="allow")
prefix_rule(pattern=["git", "switch", "-c"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "branch=\"task-graph-structured-collect-source-20260227\"; if git show-ref --verify --quiet refs/heads/$branch; then git switch $branch; else git switch -c $branch; fi && git rev-parse --abbrev-ref HEAD"], decision="allow")
prefix_rule(pattern=["git", "checkout", "-b", "feat_numeric_extraction_unification"], decision="allow")
prefix_rule(pattern=["git", "switch", "task-graph-structured-collect-source-20260227"], decision="allow")
prefix_rule(pattern=["git", "checkout", "feat_numeric_extraction_unification"], decision="allow")
prefix_rule(pattern=["git", "add", "main/backend/app/api/ingest.py", "main/backend/app/services/ingest/news.py", "main/backend/app/subprojects/online_lottery/services/news.py", "main/backend/docs/API_ROUTE_INVENTORY_2026-02-27.md", "main/backend/docs/接口层调查文档.md"], decision="allow")
prefix_rule(pattern=["git", "add", "main/backend/app/api/ingest.py", "main/backend/app/api/search.py", "main/backend/app/settings/config.py", "main/backend/app/startup_hooks.py", "main/frontend/templates/project-management.html"], decision="allow")
prefix_rule(pattern=["git", "push", "-u", "origin"], decision="allow")
prefix_rule(pattern=["git", "push", "-u", "origin", "task-graph-structured-collect-source-20260227"], decision="allow")
prefix_rule(pattern=["docker-compose", "run", "--rm", "backend", "pytest", "-q", "../backend/tests/test_*_unittest.py"], decision="allow")
prefix_rule(pattern=["docker-compose", "--profile", "test", "run", "--rm", "backend-test"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "docker compose -f main/ops/docker-compose.yml exec -T db pg_dump -U postgres -d postgres > /tmp/project_dump.sql && ls -lh /tmp/project_dump.sql"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "PGPASSWORD=postgres /opt/homebrew/opt/postgresql@16/bin/psql -h localhost -U postgres -d postgres -f /tmp/project_dump.sql"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "PGPASSWORD=postgres /opt/homebrew/opt/postgresql@16/bin/psql -h localhost -U postgres -d postgres -c \"select schema_name from information_schema.schemata where schema_name like 'project_%' order by 1;\""], decision="allow")
prefix_rule(pattern=["curl", "-sS", "http://127.0.0.1:8000/api/v1/health"], decision="allow")
prefix_rule(pattern=["brew", "install"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "PGPASSWORD=postgres /opt/homebrew/opt/postgresql@16/bin/psql -h localhost -U postgres -d postgres -Atc \"select version(), current_setting('data_directory'), current_setting('port');\""], decision="allow")
prefix_rule(pattern=["rm", "-rf", "pgvector-0.8.2", "pgvector-0.8.2.tar.gz"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "PGPASSWORD=postgres /opt/homebrew/opt/postgresql@16/bin/psql -h localhost -U postgres -d postgres -v ON_ERROR_STOP=1 -c \"DROP DATABASE IF EXISTS market_intel_local;\" -c \"CREATE DATABASE market_intel_local;\""], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "PGPASSWORD=postgres /opt/homebrew/opt/postgresql@16/bin/psql -h localhost -U postgres -d market_intel_local -v ON_ERROR_STOP=1 -c \"CREATE EXTENSION IF NOT EXISTS vector;\""], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "PGPASSWORD=postgres /opt/homebrew/opt/postgresql@16/bin/psql -h localhost -U postgres -d market_intel_local -v ON_ERROR_STOP=1 -f /tmp/project_dump.sql"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "PGPASSWORD=postgres /opt/homebrew/opt/postgresql@16/bin/psql -h localhost -U postgres -d market_intel_local -Atc \"select extname from pg_extension where extname='vector';\""], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "PGPASSWORD=postgres /opt/homebrew/opt/postgresql@16/bin/psql -h localhost -U postgres -d market_intel_local -Atc \"select count(*) from information_schema.schemata where schema_name like 'project_%';\""], decision="allow")
prefix_rule(pattern=["main/backend/.venv311/bin/python"], decision="allow")
prefix_rule(pattern=["curl", "-sS", "-m", "4", "http://127.0.0.1:8000/api/v1/process/list?limit=200&project_key=demo_proj"], decision="allow")
prefix_rule(pattern=["curl", "-sS", "-m", "4", "http://127.0.0.1:8000/api/v1/process/history?limit=30&project_key=demo_proj"], decision="allow")
prefix_rule(pattern=["pgrep", "-af", "uvicorn app.main:app|celery -A app.celery_app|celery worker"], decision="allow")
prefix_rule(pattern=["curl", "-sS", "-m", "4", "http://127.0.0.1:8000/api/v1/process/stats"], decision="allow")
prefix_rule(pattern=["ps", "-p", "92325", "-o", "pid,ppid,etime,command"], decision="allow")
prefix_rule(pattern=["pgrep", "-af", "celery.*app.celery_app|celery worker"], decision="allow")
prefix_rule(pattern=["curl", "-sS", "-m", "6", "http://127.0.0.1:8000/api/v1/process/history?limit=200&status=running&project_key=demo_proj"], decision="allow")
prefix_rule(pattern=["jq", "{total, ids:[.history[].id]}"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "cd /Users/wangyiliang/projects/信息收集工作流/main/backend && ./stop-local.sh && pkill -f 'uvicorn.*8000' || true && pkill -f 'vite.*5173' || true && nohup ./start-local.sh >/tmp/start-local.log 2>&1 & sleep 3 && (lsof -iTCP:8000 -sTCP:LISTEN -n -P || true) && (lsof -iTCP:5173 -sTCP:LISTEN -n -P || true) && curl -sS http://127.0.0.1:8000/api/v1/health"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "cd /Users/wangyiliang/projects/信息收集工作流/main/frontend-modern && nohup npm run dev -- --host 127.0.0.1 --port 5173 >/tmp/frontend-modern-dev.log 2>&1 & sleep 2 && lsof -iTCP:5173 -sTCP:LISTEN -n -P && curl -sS -m 3 http://127.0.0.1:5173/ | head -n 3"], decision="allow")
prefix_rule(pattern=["brew", "services", "start", "postgresql@16"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "cd /Users/wangyiliang/projects/信息收集工作流/main/frontend-modern && nohup npm run dev -- --host 127.0.0.1 --port 5173 >/tmp/frontend-modern-dev.log 2>&1 & sleep 3 && lsof -iTCP:5173 -sTCP:LISTEN -n -P && curl -sS -m 3 http://127.0.0.1:5173/ | head -n 3"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "cd /Users/wangyiliang/projects/信息收集工作流/main/frontend-modern && npm run build && cd /Users/wangyiliang/projects/信息收集工作流/main/backend && ./stop-local.sh || true && pkill -f 'uvicorn.*8000' || true && pkill -f 'vite.*5173' || true && nohup ./.venv311/bin/uvicorn app.main:app --host 127.0.0.1 --port 8000 --reload >/tmp/uvicorn.log 2>&1 & sleep 2 && cd /Users/wangyiliang/projects/信息收集工作流/main/frontend-modern && nohup npm run dev -- --host 127.0.0.1 --port 5173 >/tmp/frontend-modern-dev.log 2>&1 & sleep 3 && echo '--- ports ---' && (lsof -iTCP:8000 -sTCP:LISTEN -n -P || true) && (lsof -iTCP:5173 -sTCP:LISTEN -n -P || true) && echo '--- health ---' && curl -sS -m 5 http://127.0.0.1:8000/api/v1/health && echo && echo '--- vite head ---' && curl -sS -m 5 http://127.0.0.1:5173/ | head -n 3"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "cd /Users/wangyiliang/projects/信息收集工作流/main/frontend-modern && npm run build && pkill -f 'vite.*5173' || true && nohup npm run dev -- --host 127.0.0.1 --port 5173 >/tmp/frontend-modern-dev.log 2>&1 & sleep 3 && lsof -iTCP:5173 -sTCP:LISTEN -n -P && curl -sS -m 3 http://127.0.0.1:5173/ | head -n 3"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "curl -sS -m 8 http://127.0.0.1:8000/api/v1/health && echo && curl -sS -m 12 'http://127.0.0.1:8000/api/v1/process/history?status=failed&limit=20&project_key=demo_proj'"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "curl -sS -m 8 'http://127.0.0.1:8000/api/v1/process/stats?project_key=demo_proj'"], decision="allow")
prefix_rule(pattern=["./scripts/platform-macos.sh", "status"], decision="allow")
prefix_rule(pattern=["./scripts/platform-macos.sh", "local-start"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "curl -sS -m 8 http://127.0.0.1:8000/api/v1/health || true; echo; curl -sS -m 8 'http://127.0.0.1:8000/api/v1/process/stats?project_key=demo_proj' || true"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "curl -sS -m 10 'http://127.0.0.1:8000/api/v1/process/history?limit=20&project_key=demo_proj'"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "curl -sS -m 12 -X POST 'http://127.0.0.1:8000/api/v1/admin/documents/list?project_key=demo_proj' -H 'Content-Type: application/json' -d '{\\\"page\\\":1,\\\"page_size\\\":20,\\\"sort_by\\\":\\\"created_at\\\",\\\"sort_order\\\":\\\"desc\\\",\\\"doc_type\\\":\\\"social_sentiment\\\"}'"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "curl -sS -m 12 'http://127.0.0.1:8000/api/v1/admin/documents/322?project_key=demo_proj'"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "/bin/zsh -lc \"for id in 322 321 320 319 318; do echo '---' $id; curl -sS -m 8 'http://127.0.0.1:8000/api/v1/admin/documents/'$id'?project_key=demo_proj' | rg -o '\"sentiment\"|\"entities_relations\"' || true; done\""], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "curl -sS -m 12 -X POST 'http://127.0.0.1:8000/api/v1/admin/documents/list?project_key=demo_proj' -H 'Content-Type: application/json' -d '{\\\"page\\\":1,\\\"page_size\\\":100,\\\"sort_by\\\":\\\"created_at\\\",\\\"sort_order\\\":\\\"desc\\\",\\\"doc_type\\\":\\\"social_sentiment\\\"}'"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "curl -sS -m 8 'http://127.0.0.1:8000/api/v1/health?project_key=demo_proj'"], decision="allow")
prefix_rule(pattern=["/bin/zsh", "-lc", "cd /Users/wangyiliang/projects/信息收集工作流/main/frontend-modern && nohup npm run dev -- --host 127.0.0.1 --port 5173 >/tmp/frontend-modern-dev.log 2>&1 & sleep 3 && lsof -iTCP:5173 -sTCP:LISTEN -n -P && curl -sS -m 5 http://127.0.0.1:5173/ | head -n 5"], decision="allow")
prefix_rule(pattern=["git", "add", "main/backend/app/api/ingest.py", "main/backend/app/settings/config.py", "main/backend/start-local.sh", "main/backend/.env.example", "main/backend/README.local.md"], decision="allow")
prefix_rule(pattern=["git", "push", "origin", "main"], decision="allow")
